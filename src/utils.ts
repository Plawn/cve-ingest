function isSameYear(start: Date, end: Date) {
    return start.getUTCFullYear() === end.getUTCFullYear();
}

export function* getDateChunks(start: Date, end: Date): Generator<[Date, Date]> {
    // chunk should never be between years
    // should be at most a month
    if (isSameYear(start, end) && (end.getUTCMonth() - start.getUTCMonth() < 1)) {
        yield [start, end];
        return; // yield only once
    }
    let currentStart = new Date(start);
    let currentEnd = new Date(start);
    currentEnd.setUTCMonth(currentEnd.getUTCMonth() + 1);
    // yield [currentStart, currentEnd];
    while (currentEnd.getTime() < end.getTime()) {
        // check is same year
        yield [currentStart, currentEnd];
        // increment currentStart and currentEnd
        currentStart.setUTCMonth(currentEnd.getUTCMonth());
        currentEnd.setUTCMonth(currentEnd.getUTCMonth() + 1);
    }
    yield [currentStart, end];
}


function test() {
    const start = new Date(2023, 0, 1);
    const end = new Date();
    for (const i of getDateChunks(start, end)) {
        console.log(i);
    }
}

// test();